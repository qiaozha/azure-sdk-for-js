<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@azure/core-lro</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@azure/core-lro</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> @azure/core-lro</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#azure-core-lro-client-library-for-js" id="azure-core-lro-client-library-for-js" style="color: inherit; text-decoration: none;">
					<h1>Azure Core LRO client library for JS</h1>
				</a>
				<p>Azure&#39;s Core LRO is a JavaScript library that provides an API that aims to
					allow the azure-sdk-for-js public libraries to implement fully featured pollers
				to manage long running operations with the Azure services.</p>
				<p>core-lro is made following our guidelines, here: <a href="https://azure.github.io/azure-sdk/typescript_design.html#ts-lro">https://azure.github.io/azure-sdk/typescript_design.html#ts-lro</a></p>
				<p><a href="https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/core/core-lro">Source code</a></p>
				<a href="#getting-started" id="getting-started" style="color: inherit; text-decoration: none;">
					<h2>Getting started</h2>
				</a>
				<a href="#install-the-package" id="install-the-package" style="color: inherit; text-decoration: none;">
					<h3>Install the package</h3>
				</a>
				<p>Since this package is intended to be consumed by developers of the azure-sdk-for-js repository,
				you&#39;ll need to manually add the following entry to your package.json&#39;s dependencies:</p>
				<pre><code class="language-json">{
  // ...
  &quot;dependencies&quot;: {
    // ...
    &quot;@azure/core-lro&quot;: &quot;1.0.0-preview.1&quot;,
    // ...
  }
}</code></pre>
				<a href="#configure-typescript" id="configure-typescript" style="color: inherit; text-decoration: none;">
					<h3>Configure TypeScript</h3>
				</a>
				<p>TypeScript users need to have Node type definitions installed:</p>
				<pre><code class="language-bash">npm install @types/node</code></pre>
				<p>You also need to enable <code>compilerOptions.allowSyntheticDefaultImports</code> in your
					tsconfig.json. Note that if you have enabled <code>compilerOptions.esModuleInterop</code>,
					<code>allowSyntheticDefaultImports</code> is enabled by default. See <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html">TypeScript&#39;s
						compiler options
					handbook</a>
				for more information.</p>
				<a href="#key-concepts" id="key-concepts" style="color: inherit; text-decoration: none;">
					<h2>Key concepts</h2>
				</a>
				<ul>
					<li>Whenever we talk about an <strong>operation</strong>, we mean the static representation of a Long Running Operation.
						Any operation will have a definition of a state, which has a defined set of
						properties plus any property the implementations would like to add. Any
						operation will have three basic functionalities:<ol>
							<li>An update() method that will generate a new operation that might or might
							not include changes to its state.</li>
							<li>A cancel() method, which will tell the service that the operation is no longer needed.</li>
							<li>A toString() method, that will output a serialized version of the operation.</li>
						</ol>
					</li>
					<li>A <strong>Poller</strong> is an object who&#39;s main function is to interact with an operation until one of three things happen:<ol>
							<li>The poller is stopped.</li>
							<li>The operation finishes, either by succeeding or failing.</li>
							<li>The operation is cancelled.</li>
						</ol>
					</li>
				</ul>
				<p>Now we&#39;ll examine how to set up an implementation of an operation and a poller.</p>
				<a href="#examples" id="examples" style="color: inherit; text-decoration: none;">
					<h2>Examples</h2>
				</a>
				<p>You will be able to find some working examples of an implementation of an operation and a poller both in
					our test files: <a href="https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/core/core-lro/test">https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/core/core-lro/test</a>
					as well as in the azure-sdk-for-js libraries that might be currently using core-lro, which can be found here:
				<a href="https://github.com/Azure/azure-sdk-for-js/search?q=&quot;from+%40azure%5C%2Fcore-lro&quot;&amp;unscoped_q=&quot;from+%40azure%5C%2Fcore-lro&quot;">https://github.com/Azure/azure-sdk-for-js/search?q=&quot;from+%40azure%5C%2Fcore-lro&quot;&amp;unscoped_q=&quot;from+%40azure%5C%2Fcore-lro&quot;</a></p>
				<a href="#implementing-an-operation" id="implementing-an-operation" style="color: inherit; text-decoration: none;">
					<h3>Implementing an operation</h3>
				</a>
				<p>First, you&#39;ll need to import the definitions of a poll operation and its state, as follows:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">import</span> { PollOperationState, PollOperation } <span class="hljs-keyword">from</span> <span class="hljs-string">"@azure/core-lro"</span>;</code></pre>
				<p>A <strong>PollOperation</strong> requires implementing its state. We recommend extending the PollOperationState we provide.
				An example can be:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> MyOperationState <span class="hljs-keyword">extends</span> PollOperationState&lt;string&gt; {
  serviceClient: <span class="hljs-built_in">any</span>; <span class="hljs-comment">// You define all of these properties</span>
  myCustomString: <span class="hljs-built_in">string</span>;
  startedAt: <span class="hljs-built_in">Date</span>;
  finishedAt: <span class="hljs-built_in">Date</span>;
  <span class="hljs-comment">// ... and so on</span>
}</code></pre>
				<p>Now, to be able to create your custom operations, you&#39;ll need to extend the
					PollOperation class with both your operation&#39;s state and the final result
					value. For this example, we&#39;ll think on the final result value to be a string,
				but it can be any type.</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> MyPollOperation <span class="hljs-keyword">extends</span> PollOperation&lt;MyOperationState, string&gt; {}</code></pre>
				<p>Now you can make a utility function to create new instances of your operation, as follows:</p>
				<pre><code class="language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeOperation</span>(<span class="hljs-params">
  state: MyOperationState,
</span>): <span class="hljs-title">MyOperation</span> </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// We recommend you to create copies of the given state,</span>
    <span class="hljs-comment">// just to make sure that no references are left or manipulated by mistake.</span>
    state: {
      ...state,
    },
    update,
    cancel,
    toString
  };
}</code></pre>
				<p>Keep in mind that you&#39;ll need to have implemented these three functions: <code>update</code>, <code>cancel</code> and <code>toString</code>
				on order to successfully create an operation. Ideas of how you might do so follow:</p>
				<a href="#your-operation39s-update-method" id="your-operation39s-update-method" style="color: inherit; text-decoration: none;">
					<h4>Your operation&#39;s update method</h4>
				</a>
				<pre><code class="language-typescript"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params">
  <span class="hljs-keyword">this</span>: MyOperation,
  options: {
    abortSignal?: AbortSignalLike;
    fireProgress?: (state: MyOperationState) =&gt; <span class="hljs-built_in">void</span>;
  } = {}
</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">MyOperation</span>&gt; </span>{
  <span class="hljs-keyword">let</span> isDone: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">let</span> doFireProgress: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-comment">// Asyncrhonously call your service client...</span>

  <span class="hljs-comment">// You might also update the operation's state</span>
  <span class="hljs-keyword">if</span> (isDone) {
    <span class="hljs-keyword">this</span>.state.completed = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.state.result = <span class="hljs-string">"Done"</span>;
  }

  <span class="hljs-comment">// You can also arbitrarily report progress</span>
  <span class="hljs-keyword">if</span> (doFireProgress) {
    options.fireProgress(state);
  }

  <span class="hljs-keyword">return</span> makeOperation(<span class="hljs-keyword">this</span>.state);
}</code></pre>
				<a href="#your-operation39s-cancel-method" id="your-operation39s-cancel-method" style="color: inherit; text-decoration: none;">
					<h4>Your operation&#39;s cancel method</h4>
				</a>
				<pre><code class="language-typescript"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cancel</span>(<span class="hljs-params">
  <span class="hljs-keyword">this</span>: MyOperation,
  options: { abortSignal?: AbortSignal } = {}
</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">MyOperation</span>&gt; </span>{
  <span class="hljs-comment">// Reach out to your service to trigger the cancellation of the operation</span>

  <span class="hljs-keyword">return</span> makeOperation(
    {
      ...this.state,
      cancelled: <span class="hljs-literal">true</span>
    }
  );
}</code></pre>
				<a href="#your-operation39s-tostring-method" id="your-operation39s-tostring-method" style="color: inherit; text-decoration: none;">
					<h4>Your operation&#39;s toString method</h4>
				</a>
				<pre><code class="language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toString</span>(<span class="hljs-params"><span class="hljs-keyword">this</span>: MyOperation</span>): <span class="hljs-title">string</span> </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify({
    state: {
      ...this.state,
      <span class="hljs-comment">// Only the plain text properties, for examle</span>
    }
  });
}</code></pre>
				<a href="#implementing-a-poller" id="implementing-a-poller" style="color: inherit; text-decoration: none;">
					<h3>Implementing a poller</h3>
				</a>
				<p>To implement a poller, you must pull in the definitions of your operation and extend core-lro&#39;s poller, as follows:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">import</span> { Poller } <span class="hljs-keyword">from</span> <span class="hljs-string">"@azure/core-lro"</span>;
<span class="hljs-keyword">import</span> { makeOperation, MyOperation, MyOperationState } <span class="hljs-keyword">from</span> <span class="hljs-string">"./myOperation"</span>;

<span class="hljs-comment">// See that "string" here is the type of the result</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> MyPoller <span class="hljs-keyword">extends</span> Poller&lt;MyOperationState, <span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">constructor</span>(<span class="hljs-params">
    baseOperation?: MyOperation,
    onProgress?: (state: MyOperationState) =&gt; <span class="hljs-built_in">void</span>
  </span>) {
    <span class="hljs-keyword">let</span> state: MyOperationState = {};

    <span class="hljs-keyword">if</span> (baseOperation) {
      state = baseOperation.state;
    }

    <span class="hljs-keyword">const</span> operation = makeOperation(state);

    <span class="hljs-keyword">super</span>(operation);

    <span class="hljs-comment">// Setting up the poller to call progress when the operation decides.</span>
    <span class="hljs-comment">// This ties to the operation's update method, which receives a</span>
    <span class="hljs-comment">// fireProgress method in the optional properties.</span>
    <span class="hljs-keyword">if</span> (onProgress) {
      <span class="hljs-keyword">this</span>.onProgress(onProgress);
    }
  }

  <span class="hljs-keyword">async</span> delay(): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// Your own implementation of a delay</span>
  }
}</code></pre>
				<a href="#using-your-poller" id="using-your-poller" style="color: inherit; text-decoration: none;">
					<h3>Using your poller</h3>
				</a>
				<p>Here&#39;s one simple examle of your poller in action. More examples can be found in the test folder near this README.</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> poller = <span class="hljs-keyword">new</span> MyPoller();

<span class="hljs-comment">// Waiting until the operation completes</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> poller.pollUntilDone();
<span class="hljs-keyword">const</span> state = poller.getOperationState();

<span class="hljs-built_in">console</span>.log(state.completed);</code></pre>
				<a href="#troubleshooting" id="troubleshooting" style="color: inherit; text-decoration: none;">
					<h2>Troubleshooting</h2>
				</a>
				<a href="#enable-logs" id="enable-logs" style="color: inherit; text-decoration: none;">
					<h3>Enable logs</h3>
				</a>
				<p>TODO.</p>
				<a href="#next-steps" id="next-steps" style="color: inherit; text-decoration: none;">
					<h2>Next steps</h2>
				</a>
				<p>TODO.</p>
				<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
					<h2>Contributing</h2>
				</a>
				<p>This project welcomes contributions and suggestions. Please read the
					<a href="https://github.com/Azure/azure-sdk-for-js/blob/master/CONTRIBUTING.md">contributing guidelines</a>
				for detailed information about how to contribute and what to expect while contributing.</p>
				<a href="#testing" id="testing" style="color: inherit; text-decoration: none;">
					<h3>Testing</h3>
				</a>
				<p>To run our tests, first install the dependencies (with <code>npm install</code> or <code>rush install</code>),
				then run the unit tests with: <code>npm run unit-test</code>.</p>
				<a href="#code-of-conduct" id="code-of-conduct" style="color: inherit; text-decoration: none;">
					<h3>Code of Conduct</h3>
				</a>
				<p>This project has adopted the <a href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>.
					For more information see the <a href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or
				contact <a href="mailto:opencode@microsoft.com">opencode@microsoft.com</a> with any additional questions or comments.</p>
				<p><img src="https://azure-sdk-impressions.azurewebsites.net/api/impressions/azure-sdk-for-js/sdk/core/core-lro/README.png" alt="Impressions"></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-class tsd-has-type-parameter">
						<a href="classes/poller.html" class="tsd-kind-icon">Poller</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/pollercancellederror.html" class="tsd-kind-icon">Poller<wbr>Cancelled<wbr>Error</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/pollerstoppederror.html" class="tsd-kind-icon">Poller<wbr>Stopped<wbr>Error</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/polloperationbase.html" class="tsd-kind-icon">Poll<wbr>Operation<wbr>Base</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/polloperationstate.html" class="tsd-kind-icon">Poll<wbr>Operation<wbr>State</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/pollerlike.html" class="tsd-kind-icon">Poller<wbr>Like</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="globals.html#cancelonprogress" class="tsd-kind-icon">Cancel<wbr>OnProgress</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter">
						<a href="globals.html#polloperation" class="tsd-kind-icon">Poll<wbr>Operation</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter">
						<a href="globals.html#pollprogresscallback" class="tsd-kind-icon">Poll<wbr>Progress<wbr>Callback</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>